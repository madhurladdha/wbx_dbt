{{
    config(
        tags=["ax_hist_fact","ax_hist_sales","ax_hist_on_demand"]
    )
}}


with
    source as (

        select * from {{ source("FACTS_FOR_COMPARE", "sls_wtx_forecast_over_fact") }} where  {{env_var("DBT_PICK_FROM_CONV")}}='Y'

    ),

    renamed as (

        select
            source_system,
            source_item_identifier,
            item_guid,
            plan_customer_addr_number_guid,
            plan_source_customer_code,
            scen_code,
            scenario_guid,
            calendar_date,
            snapshot_date,
            override_flag,
            is_vol_total_nonzero,
            isonpromo_si,
            isonpromo_so,
            ispreorpostpromo_si,
            ispreorpostpromo_so,
            listingactive,
            qty_ca_cannib_loss_si,
            qty_ca_cannib_loss_so,
            qty_ca_effective_base_fc_si,
            qty_ca_effective_base_fc_so,
            qty_ca_override_si,
            qty_ca_override_so,
            qty_ca_pp_dip_si,
            qty_ca_pp_dip_so,
            qty_ca_promo_total_si,
            qty_ca_promo_total_so,
            qty_ca_si_actual,
            qty_ca_so_actual,
            qty_ca_stat_base_fc_si,
            qty_ca_stat_base_fc_so,
            qty_ca_total_adjust_si,
            qty_ca_total_adjust_so,
            qty_ca_total_si,
            qty_ca_total_so,
            qty_kg_cannib_loss_si,
            qty_kg_cannib_loss_so,
            qty_kg_effective_base_fc_si,
            qty_kg_effective_base_fc_so,
            qty_kg_override_si,
            qty_kg_override_so,
            qty_kg_pp_dip_si,
            qty_kg_pp_dip_so,
            qty_kg_promo_total_si,
            qty_kg_promo_total_so,
            qty_kg_si_actual,
            qty_kg_so_actual,
            qty_kg_stat_base_fc_si,
            qty_kg_stat_base_fc_so,
            qty_kg_total_adjust_si,
            qty_kg_total_adjust_so,
            qty_kg_total_si,
            qty_kg_total_so,
            qty_ul_cannib_loss_si,
            qty_ul_cannib_loss_so,
            qty_ul_effective_base_fc_si,
            qty_ul_effective_base_fc_so,
            qty_ul_override_si,
            qty_ul_override_so,
            qty_ul_pp_dip_si,
            qty_ul_pp_dip_so,
            qty_ul_promo_total_si,
            qty_ul_promo_total_so,
            qty_ul_si_actual,
            qty_ul_so_actual,
            qty_ul_stat_base_fc_si,
            qty_ul_stat_base_fc_so,
            qty_ul_total_adjust_si,
            qty_ul_total_adjust_so,
            qty_ul_total_si,
            qty_ul_total_so,
            total_baseretentionpercentage,
            total_si_preorpostdippercentage,
            total_so_preorpostdippercentage,
            ap_added_value_pack,
            ap_avp_disc,
            ap_avp_disc_mgmt_adjustment,
            ap_avp_disc_pre_adjustment,
            ap_cash_disc,
            ap_cash_disc_mgmt_adjustment,
            ap_cash_disc_pre_adjustment,
            ap_category,
            ap_category_mgmt_adjustment,
            ap_category_pre_adjustment,
            ap_direct_shopper_marketing,
            ap_direct_shopper_marketing_mgmt_adjustment,
            ap_direct_shopper_marketing_pre_adjustment,
            ap_early_settlement_disc,
            ap_early_settlement_disc_mgmt_adjustment,
            ap_early_settlement_disc_pre_adjustment,
            ap_everyday_low_prices,
            ap_everyday_low_prices_mgmt_adjustment,
            ap_everyday_low_prices_pre_adjustment,
            ap_field_marketing,
            ap_field_marketing_mgmt_adjustment,
            ap_field_marketing_pre_adjustment,
            ap_fixed_annual_payments,
            ap_fixed_annual_payments_mgmt_adjustment,
            ap_fixed_annual_payments_pre_adjustment,
            ap_fixed_trade_cust_invoiced,
            ap_fixed_trade_non_cust_invoiced,
            ap_gcat_actuals,
            ap_gcat_standard,
            ap_gross_margin_actual,
            ap_gross_margin_standard,
            ap_gross_sales_value,
            ap_gross_selling_value,
            ap_gross_selling_value_mgmt_adjustment,
            ap_gross_selling_value_pre_adjustment,
            ap_growth_incentives,
            ap_growth_incentives_mgmt_adjustment,
            ap_growth_incentives_pre_adjustment,
            ap_indirect_shopper_marketing,
            ap_indirect_shopper_marketing_mgmt_adjustment,
            ap_indirect_shopper_marketing_pre_adjustment,
            ap_invoiced_sales_value,
            ap_net_net_sales_value,
            ap_net_realisable_revenue,
            ap_net_sales_value,
            ap_off_invoice_disc,
            ap_off_invoice_disc_mgmt_adjustment,
            ap_off_invoice_disc_pre_adjustment,
            ap_other_direct_payments,
            ap_other_direct_payments_mgmt_adjustment,
            ap_other_direct_payments_pre_adjustment,
            ap_other_indirect_payments,
            ap_other_indirect_payments_mgmt_adjustment,
            ap_other_indirect_payments_pre_adjustment,
            ap_permanent_disc,
            ap_promo_fixed_funding,
            ap_promo_fixed_funding_mgmt_adjustment,
            ap_promo_fixed_funding_pre_adjustment,
            ap_range_support_allowance,
            ap_range_support_allowance_mgmt_adjustment,
            ap_range_support_allowance_pre_adjustment,
            ap_range_support_incentives,
            ap_range_support_incentives_mgmt_adjustment,
            ap_range_support_incentives_pre_adjustment,
            ap_retail_cost_of_sales,
            ap_retail_margin_excl_fixed_funding,
            ap_retail_margin_incl_fixed_funding,
            ap_retail_promo_fixed_spend,
            ap_retail_retailer_retro_funding,
            ap_retail_revenue_mrrsp,
            ap_retail_revenue_net,
            ap_retail_revenue_net_excl_mrrsp,
            ap_retail_revenue_net_excl_rsp,
            ap_retail_revenue_rsp,
            ap_retail_total_spend,
            ap_retro,
            ap_retro_mgmt_adjustment,
            ap_retro_pre_adjustment,
            ap_tot_prime_cost_standard,
            ap_tot_prime_cost_standard_mgmt_adjustment,
            ap_tot_prime_cost_standard_pre_adjustment,
            ap_tot_prime_cost_variance,
            ap_tot_prime_cost_variance_mgmt_adjustment,
            ap_tot_prime_cost_variance_pre_adjustment,
            ap_total_trade,
            ap_total_trade_cust_invoiced,
            ap_variable_trade,
            promo_vol,
            promo_vol_kg,
            promo_vol_ul,
            retail_tot_vol_ca,
            retail_tot_vol_kg,
            retail_tot_vol_sgl,
            retail_tot_vol_sgl_ca,
            retail_tot_vol_sgl_ul,
            retail_tot_vol_sp_base_uom,
            retail_tot_vol_sp_kg_uom,
            retail_tot_vol_sp_ul_uom,
            retail_tot_vol_ul,
            tot_vol_ca,
            tot_vol_kg,
            tot_vol_sgl,
            tot_vol_sgl_ca,
            tot_vol_sgl_ul,
            tot_vol_sp_base_uom,
            tot_vol_sp_base_uom_mgmt_adjustment,
            tot_vol_sp_base_uom_pre_adjustment,
            tot_vol_sp_kg_uom,
            tot_vol_sp_kg_uom_mgmt_adjustment,
            tot_vol_sp_kg_uom_pre_adjustment,
            tot_vol_sp_ul_uom,
            tot_vol_sp_ul_uom_mgmt_adjustment,
            tot_vol_sp_ul_uom_pre_adjustment,
            tot_vol_ul,
            fcf_tot_vol_kg,
            fcf_tot_vol_ca,
            fcf_tot_vol_ul,
            fcf_base_vol_kg,
            fcf_base_vol_ca,
            fcf_base_vol_ul,
            fcf_promo_vol_kg,
            fcf_promo_vol_ca,
            fcf_promo_vol_ul,
            fcf_over_vol_kg,
            fcf_over_vol_ca,
            fcf_over_vol_ul,
            gl_unit_price,
            raw_material_unit_price,
            ap_tot_prime_cost_standard_raw,
            packaging_unit_price,
            ap_tot_prime_cost_standard_packaging,
            labour_unit_price,
            ap_tot_prime_cost_standard_labour,
            bought_in_unit_price,
            ap_tot_prime_cost_standard_bought_in,
            other_unit_price,
            ap_tot_prime_cost_standard_other,
            co_pack_unit_price,
            ap_tot_prime_cost_standard_co_pack,
            rate_ap_added_value_pack,
            rate_ap_permanent_disc,
            rate_ap_invoiced_sales_value,
            rate_ap_net_sales_value,
            rate_ap_net_realisable_revenue,
            rate_ap_variable_trade,
            rate_ap_net_net_sales_value,
            rate_ap_fixed_trade_cust_invoiced,
            rate_ap_total_trade_cust_invoiced,
            rate_ap_fixed_trade_non_cust_invoiced,
            rate_ap_total_trade,
            rate_ap_gross_margin_standard,
            rate_ap_gross_margin_actual,
            rate_ap_gcat_standard,
            rate_ap_gcat_actuals,
            rate_ap_fixed_annual_payments_pre_adj,
            rate_ap_fixed_annual_payments_mgmt_adj,
            rate_ap_fixed_annual_payments,
            rate_ap_category_pre_adj,
            rate_ap_category_mgmt_adj,
            rate_ap_category,
            rate_ap_promo_fixed_funding_pre_adj,
            rate_ap_promo_fixed_funding_mgmt_adj,
            rate_ap_promo_fixed_funding,
            rate_ap_cash_disc_pre_adj,
            rate_ap_cash_disc_mgmt_adj,
            rate_ap_cash_disc,
            rate_ap_direct_shopper_marketing_pre_adj,
            rate_ap_direct_shopper_marketing_mgmt_adj,
            rate_ap_direct_shopper_marketing,
            rate_ap_range_support_allowance_pre_adj,
            rate_ap_range_support_allowance_mgmt_adj,
            rate_ap_range_support_allowance,
            rate_ap_range_support_incentives_pre_adj,
            rate_ap_range_support_incentives_mgmt_adj,
            rate_ap_range_support_incentives,
            rate_ap_indirect_shopper_marketing_pre_adj,
            rate_ap_indirect_shopper_marketing_mgmt_adj,
            rate_ap_indirect_shopper_marketing,
            rate_ap_retro_pre_adj,
            rate_ap_retro_mgmt_adj,
            rate_ap_retro,
            rate_ap_avp_disc_pre_adj,
            rate_ap_avp_disc_mgmt_adj,
            rate_ap_avp_disc,
            rate_ap_everyday_low_prices_pre_adj,
            rate_ap_everyday_low_prices_mgmt_adj,
            rate_ap_everyday_low_prices,
            rate_ap_off_invoice_disc_pre_adj,
            rate_ap_off_invoice_disc_mgmt_adj,
            rate_ap_off_invoice_disc,
            rate_ap_field_marketing_pre_adj,
            rate_ap_field_marketing_mgmt_adj,
            rate_ap_field_marketing,
            rate_ap_tot_prime_cost_variance_pre_adj,
            rate_ap_tot_prime_cost_variance_mgmt_adj,
            rate_ap_tot_prime_cost_variance,
            rate_ap_tot_prime_cost_standard_pre_adj,
            rate_ap_tot_prime_cost_standard_mgmt_adj,
            rate_ap_tot_prime_cost_standard,
            rate_ap_early_settlement_disc_pre_adj,
            rate_ap_early_settlement_disc_mgmt_adj,
            rate_ap_early_settlement_disc,
            rate_ap_other_direct_payments_pre_adj,
            rate_ap_other_direct_payments_mgmt_adj,
            rate_ap_other_direct_payments,
            rate_ap_other_indirect_payments_pre_adj,
            rate_ap_other_indirect_payments_mgmt_adj,
            rate_ap_other_indirect_payments,
            rate_ap_gross_selling_value_pre_adj,
            rate_ap_gross_selling_value_mgmt_adj,
            rate_ap_gross_selling_value,
            rate_ap_gross_sales_value,
            rate_ap_growth_incentives_pre_adj,
            rate_ap_growth_incentives_mgmt_adj,
            rate_ap_growth_incentives,
            rate_retail_tot_vol_sgl,
            rate_retail_tot_vol_sgl_ca,
            rate_retail_tot_vol_sgl_ul,
            rate_retail_tot_vol_kg,
            rate_retail_tot_vol_ca,
            rate_retail_tot_vol_ul,
            rate_ap_retail_revenue_mrrsp,
            rate_ap_retail_revenue_rsp,
            rate_ap_retail_revenue_net,
            rate_ap_retail_cost_of_sales,
            rate_ap_retail_retailer_retro_funding,
            rate_ap_retail_margin_excl_fixed_funding,
            rate_ap_retail_promo_fixed_spend,
            rate_ap_retail_total_spend,
            rate_ap_retail_margin_incl_fixed_funding,
            rate_ap_retail_revenue_net_excl_mrrsp,
            rate_ap_retail_revenue_net_excl_rsp,
            fcf_tot_orig_vol_kg,
            fcf_tot_orig_vol_ca,
            fcf_tot_orig_vol_ul

        from source

    )

select *
from renamed
