with d365_source as (

        select *
        from {{ source("D365", "purch_table") }} where _FIVETRAN_DELETED='FALSE' AND upper(trim(data_area_id)) in {{env_var("DBT_D365_COMPANY_FILTER")}} 
    ),

    renamed as (
        select
            'D365' as source,
            purch_id as purchid,
            purch_name as purchname,
            order_account as orderaccount,
            invoice_account as invoiceaccount,
            null as freightzone,
            email as email,
            delivery_date as deliverydate,
            delivery_type as deliverytype,             
            address_ref_rec_id as addressrefrecid,
            address_ref_table_id as addressreftableid,
            inter_company_original_sales_id as intercompanyoriginalsalesid,
            null as intercompanyoriginalcustacct,
            currency_code as currencycode,
            payment as payment,
            null as cashdisc,
            null as countyorigdest,
            inter_company_direct_delivery as intercompanydirectdelivery,
            vend_group as vendgroup,
            null as linedisc,
            disc_percent as discpercent,
            null as pricegroupid,
            null as multilinedisc,
            null as enddisc,
            null as intercocustpurchorderformnum,
            tax_group as taxgroup,
            dlv_term as dlvterm,
            dlv_mode as dlvmode,
            purch_status as purchstatus,
            null as markupgroup,
            purchase_type as purchasetype,
            null as url,
            posting_profile as postingprofile,
            null as transactioncode,
            null as enterprisenumber,
            settle_voucher as settlevoucher,
            null as intercoallowindirectcreation,
            inter_company_origin as intercompanyorigin,
            cash_disc_percent as cashdiscpercent,
            delivery_name as deliveryname,
            cov_status as covstatus,
            null as paymentsched,
            invent_site_id as inventsiteid,
            one_time_vendor as onetimevendor,
            return_item_num as returnitemnum,
            freight_slip_type as freightsliptype,
            document_status as documentstatus,
            null as contactpersonid,
            invent_location_id as inventlocationid,
            null as bankcentralbankpurposecode,
            item_buyer_group_id as itembuyergroupid,
            null as projid,
            purch_pool_id as purchpoolid,
            vatnum as vatnum,
            null as port,
            incl_tax as incltax,
            null as bankcentralbankpurposetext,
            null as numbersequencegroup,
            language_id as languageid,
            auto_summary_module_type as autosummarymoduletype,
            null as transport,
            paym_mode as paymmode,
            null as paymspec,
            fixed_due_date as fixedduedate,
            null as statprocid,
            vendor_ref as vendorref,
            inter_company_company_id as intercompanycompanyid,
            inter_company_sales_id as intercompanysalesid,
            inter_company_order as intercompanyorder,
            null as returnreasoncodeid,
            return_replacement_created as returnreplacementcreated,
            null as reqattention,             
            default_dimension as defaultdimension,
            confirmed_dlv_earliest as confirmeddlvearliest,
            null as contractnum_sa,
            change_request_required as changerequestrequired,             
            reason_table_ref as reasontableref,
            document_state as documentstate,
            is_modified as ismodified,             
            matching_agreement as matchingagreement,
            system_entry_source as systementrysource,             
            system_entry_change_policy as systementrychangepolicy,
            manual_entry_changepolicy as manualentrychangepolicy,
            vend_invoice_declaration_is as vendinvoicedeclaration_is,             
            worker_purch_placer as workerpurchplacer,             
            delivery_postal_address as deliverypostaladdress,
            bank_document_type as bankdocumenttype,
            list_code as listcode,
            is_encumbrance_required as isencumbrancerequired,             
            source_document_line as sourcedocumentline,             
            source_document_header as sourcedocumentheader,             
            requester as requester,
            accounting_distribution_template as accountingdistributiontemplate,
            accounting_date as accountingdate,
            finalize_closing_date as finalizeclosingdate,
            cons_target_jp as constarget_jp,
            intrastat_fulfillment_date_hu as intrastatfulfillmentdate_hu,
            united_vatinvoice_lt as unitedvatinvoice_lt,
            intrastat_add_value_lv as intrastataddvalue_lv,
            null as invoiceregister_lt,
            null as packingslipregister_lt,
            null as servicename,
            null as serviceaddress,
            one_time_supplier as onetimesupplier,
            service_date as servicedate,
            confirmed_dlv as confirmeddlv,
            fshauto_created as fshautocreated,
            cross_docking_date as crossdockingdate,
            null as servicecategory,
            avail_sales_date as availsalesdate,
            local_delivery_date as localdeliverydate,
            replenishment_location as replenishmentlocation,
            retail_retail_status_type as retailretailstatustype,
            null as retaildriverdetails,
            null as retailconcessionpurch,
            confirming_po as confirmingpo,
            mcrdrop_shipment as mcrdropshipment,
            exchange_rate_date as exchangeratedate,
            fixed_exch_rate as fixedexchrate,
            null as tamvendrebategroupid,
            null as taxperiodpaymentcode_pl,
            transportation_document as transportationdocument,
            createddatetime as createddatetime,
            createdby as createdby,
            upper(data_area_id) as dataareaid,
            recversion as recversion,
            partition as partition,
            recid as recid,
            null as wbxinvoicehandling,
            null as bisedidelivery,
            null as bisediprocess
        from d365_source

    )

select *
from renamed
