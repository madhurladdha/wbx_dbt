with d365_source as (
        select *
        from {{ source("D365", "sales_table") }} where _FIVETRAN_DELETED='FALSE' and upper(data_area_id) in {{env_var("DBT_D365_COMPANY_FILTER")}}


    ),

    renamed as (
        select
            'D365' as source,
            sales_id as salesid,
            sales_name as salesname,
            reservation as reservation,
            cust_account as custaccount,
            invoice_account as invoiceaccount,
            delivery_date as deliverydate,
            null as url,
            purch_order_form_num as purchorderformnum,
            null as salesgroup,
            freight_slip_type as freightsliptype,
            document_status as documentstatus,
            null as intercompanyoriginalsalesid,
            currency_code as currencycode,
            payment as payment,
            null as cashdisc,
            tax_group as taxgroup,
            line_disc as linedisc,
            cust_group as custgroup,
            disc_percent as discpercent,
            null as intercooriginalcustaccount,
            price_group_id as pricegroupid,
            null as multilinedisc,
            null as enddisc,
            cast(customer_ref as varchar(255)) as customerref,
            null as countyorigdest,
            listcode as listcode,
            dlv_term as dlvterm,
            dlv_mode as dlvmode,
            null as purchid,
            sales_status as salesstatus,
            markup_group as markupgroup,
            sales_type as salestype,
            null as salespoolid,
            posting_profile as postingprofile,
            null as transactioncode,
            inter_company_auto_create_orders as intercompanyautocreateorders,
            inter_company_direct_delivery as intercompanydirectdelivery,
            inter_company_direct_delivery_orig as intercompanydirectdeliveryorig,
            settle_voucher as settlevoucher,
            null as enterprisenumber,
            inter_company_allow_indirect_creation as intercoallowindirectcreation,
            inter_company_allow_indirect_creation_orig as intercoallowindirectcreatorig,
            delivery_name as deliveryname,
            one_time_customer as onetimecustomer,
            cov_status as covstatus,
            null as commissiongroup,
            null as paymentsched,
            inter_company_origin as intercompanyorigin,
            email as email,
            null as freightzone,
            return_item_num as returnitemnum,
            cash_disc_percent as cashdiscpercent,
            null as contactpersonid,
            deadline as deadline,
            null as projid,
            invent_location_id as inventlocationid,
            address_ref_table_id as addressreftableid,
            vatnum as vatnum,
            null as port,
            incl_tax as incltax,
            einvoice_line_spec as einvoicelinespec,
            null as numbersequencegroup,
            fixed_exch_rate as fixedexchrate,
            language_id as languageid,
            auto_summary_module_type as autosummarymoduletype,
            giro_type as girotype,
            sales_origin_id as salesoriginid,
            estimate as estimate,
            null as transport,
            paym_mode as paymmode,
            null as paymspec,
            fixed_due_date as fixedduedate,
            null as exportreason,
            null as statprocid,
            null as bankcentralbankpurposetext,
            inter_company_company_id as intercompanycompanyid,
            inter_company_purch_id as intercompanypurchid,
            inter_company_order as intercompanyorder,
            null as dlvreason,
            null as quotationid,
            receipt_date_requested as receiptdaterequested,
            receipt_date_confirmed as receiptdateconfirmed,
            shipping_date_requested as shippingdaterequested,
            shipping_date_confirmed as shippingdateconfirmed,
            null as bankcentralbankpurposecode,
            null as einvoiceaccountcode,
            itemtagging as itemtagging,
            casetagging as casetagging,
            pallettagging as pallettagging,
            address_ref_rec_id as addressrefrecid,
            null as custinvoiceid,
            invent_site_id as inventsiteid,
            default_dimension as defaultdimension,
            credit_card_cust_ref_id as creditcardcustrefid,
            null as shipcarrieraccount,
            null as shipcarrierid,
            null as shipcarrierfuelsurcharge,
            ship_carrier_blind_shipment as shipcarrierblindshipment,
            null as shipcarrierdeliverycontact,
            credit_card_approval_amount as creditcardapprovalamount,
            null as creditcardauthorization,
            return_deadline as returndeadline,
            null as returnreplacementid,
            return_status as returnstatus,
            return_reason_code_id as returnreasoncodeid,
            credit_card_authorization_error as creditcardauthorizationerror,
            null as shipcarrieraccountcode,
            return_replacement_created as returnreplacementcreated,
            ship_carrier_dlv_type as shipcarrierdlvtype,
            delivery_date_control_type as deliverydatecontroltype,
            null as shipcarrierexpeditedshipment,
            ship_carrier_residential as shipcarrierresidential,
            matching_agreement as matchingagreement,
            system_entry_source as systementrysource,
            system_entry_change_policy as systementrychangepolicy,
            manual_entry_changepolicy as manualentrychangepolicy,
            delivery_postal_address as deliverypostaladdress,
            ship_carrier_postal_address as shipcarrierpostaladdress,
            null as shipcarriername,
            worker_sales_taker  as workersalestaker,
            source_document_header as sourcedocumentheader,
            bank_document_type as bankdocumenttype,
            null as salesunitid,
            smm_sales_amount_total as smmsalesamounttotal,
            null as smmcampaignid,
            customs_export_order_in as customsexportorder_in,
            customs_shipping_bill_in as customsshippingbill_in,
            null as tdsgroup_in,
            null as tcsgroup_in,
            nature_of_assessee_in as natureofassessee_in,
            cons_target_jp as constarget_jp,
            intrastat_fulfillment_date_hu as intrastatfulfillmentdate_hu,
            united_vatinvoice_lt as unitedvatinvoice_lt,
            intrastat_add_value_lv as intrastataddvalue_lv,
            invoice_auto_numbering_lt as invoiceregister_lt,
            packing_slip_auto_numbering_lt as packingslipregister_lt,
            null as bankaccount_lv,
            cash_disc_base_date as cashdiscbasedate,
            cash_disc_base_days as cashdiscbasedays,
            credit_note_reason_code as creditnotereasoncode,
            null as curbankaccount_lv,
            null as custbankaccount_lv,
            null as daxintegrationid,
            direct_debit_mandate as directdebitmandate,
            fiscal_doc_type_pl as fiscaldoctype_pl,
            mcrorder_stopped as mcrorderstopped,
            pds_batch_attrib_auto_res as pdsbatchattribautores,
            null as pdscustrebategroupid,
            null as pdsrebateprogramtmagroup,
            release_status as releasestatus,
            null as taxperiodpaymentcode_pl,
            transportation_document as transportationdocument,
            worker_sales_responsible as workersalesresponsible,
            modifieddatetime as modifieddatetime,
            null as del_modifiedtime,
            modifiedby as modifiedby,
            modifiedtransactionid as modifiedtransactionid,
            createddatetime as createddatetime,
            null as del_createdtime,
            createdby as createdby,
            createdtransactionid  as createdtransactionid,
            upper(data_area_id) as dataareaid,
            recversion as recversion,
            partition  as partition,
            recid  as recid,
            cast(wbxaccount_number as varchar(255)) as wbxaccountnumber,
            null as wbxcancelreasoncode,
            null as wbxcontractnumber,
            wbxcontractor_indicator as wbxcontractorindicator,
            wbxedidelivery_instructions as wbxdeliveryinstruction,
            null as wbxfullpallet,
            wbxone_product_per_pallet as wbxoneproductperpallet,
            null as wbxordercreationtype,
            wbxrequested_receipt_time as wbxrequestedreceipttime,
            wbxsend_date_and_time as wbxsenddatetime,
            wbxsenddateandtimetzid as wbxsenddatetimetzid,
            null as wbxshelflife,
            null as wbxshelflifecheckneeded,
            wbxorder_waved as wbxwaved,
            wbxpodrequired as wbxpodrequired,
            null as wbxtotalsoqtydisc,
            null as wbxadditionaldisc,
            null as bisediconfirmation,
            null as bisedidelivery,
            null as bisediinvoice,
            null as bisedireturn,
            null as bisedipicking,
            retail_channel_table as retailchanneltable,
            null as ecommerceoperator_in,
            null as ecommerceoperatorgstin_in,
            null as ecommercesale_in,
            null as merchantid_in,
            null as provisionalassessment_in,
            null as allowzeropriceapprovedby,
            null as allowzeropriceapproveddate,
            null as allowzeroprices,
            null as pricecalculated,
            null as einvoicecfdiconfirmnumber_mx,
            null as satpaymmethod_mx,
            null as satpurpose_mx
        from d365_source

    )

select * from renamed
