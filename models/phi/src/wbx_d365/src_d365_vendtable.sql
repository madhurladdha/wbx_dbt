with d365_source as (
        select *
        from {{ source("D365", "vend_table") }} where _FIVETRAN_DELETED='FALSE' and upper(data_area_id) in {{env_var("DBT_D365_COMPANY_FILTER")}}

    ),

renamed as (
    select
        'D365' as source,
        account_num as accountnum,
        invoice_account as invoiceaccount,
        vend_group as vendgroup,
        paym_term_id as paymtermid,
        null as cashdisc,
        currency as currency,
        null as linedisc,
        null as enterprisenumber,
        blocked as blocked,
        one_time_vendor as onetimevendor,
        null as pricegroup,
        null as multilinedisc,
        null as enddisc,
        null as paymid,
        vatnum as vatnum,
        invent_location as inventlocation,
        null as youraccountnum,
        dlv_term as dlvterm,
        dlv_mode as dlvmode,
        null as bankaccount,
        paym_mode as paymmode,
        null as paymspec,
        null as markupgroup,
        null as clearingperiod,
        null as companyidsiret,
        tax_group as taxgroup,
        null as freightzone,
        minority_owned as minorityowned,
        female_owned as femaleowned,
        null as creditrating,
        credit_max as creditmax,
        tax_1099_reports as tax1099reports,
        null as tax1099regnum,
        null as paymsched,
        null as itembuyergroupid,
        null as contactpersonid,
        purch_pool_id as purchpoolid,
        purch_amount_purchase_order as purchamountpurchaseorder,
        incl_tax as incltax,
        null as venditemgroupid,
        null as numbersequencegroup,
        null as paymdayid,
        null as destinationcodeid,
        line_of_business_id as lineofbusinessid,
        null as suppitemgroupid,
        null as bankcentralbankpurposetext,
        null as bankcentralbankpurposecode,
        offset_account_type as offsetaccounttype,
        null as purchcalendarid,
        null as organizationnumber,
        null as fiscalcode,
        tax_withhold_calculate as taxwithholdcalculate,
        null as taxwithholdgroup,
        null as birthdate,
        null as birthplace,
        null as residenceforeigncntyregid,
        null as namecontrol,
        foreign_entity_indicator as foreignentityindicator,
        tax_idtype as taxidtype,
        null as dba,
        tax_1099_name_choice as tax1099namechoice,
        second_tin as secondtin,
        invent_site_id as inventsiteid,
        segment_id as segmentid,
        subsegment_id as subsegmentid,
        company_chain_id as companychainid,
        null as vendpricetolerancegroupid,
        null as memo,
        small_business as smallbusiness,
        locally_owned as locallyowned,
        bid_only as bidonly,
        w_9 as w9,
        null as orgid,
        null as factoringaccount,
        matching_policy as matchingpolicy,
        blocked_release_date as blockedreleasedate,
        blockedreleasedatetzid as blockedreleasedatetzid,
        w_9_included as w9included,
        vend_exception_group as vendexceptiongroup,
        party as party,
        default_dimension as defaultdimension,
        offset_ledger_dimension as offsetledgerdimension,
        null as birthcountycode_it,
        heir_it as heir_it,
        change_request_enabled as changerequestenabled,
        change_request_allow_override as changerequestallowoverride,
        change_request_override as changerequestoverride,
        company_nafcode as companynafcode,
        vend_invoice_declaration_is as vendinvoicedeclaration_is,
        tax_1099_fields as tax1099fields,
        vendor_type_mx as vendortype_mx,
        null as foreigntaxregistration_mx,
        null as nationality_mx,
        null as diotcountrycode_mx,
        operation_type_mx as operationtype_mx,
        main_contact_worker as maincontactworker,
        company_type_mx as companytype_mx,
        null as rfc_mx,
        null as curp_mx,
        null as stateinscription_mx,
        null as ccmnum_br,
        null as ienum_br,
        null as cnpjcpfnum_br,
        null as vendincomecode_br,
        non_taxable_br as nontaxable_br,
        vend_consumption_br as vendconsumption_br,
        null as nit_br,
        null as insscei_br,
        null as cnae_br,
        icmscontributor_br as icmscontributor_br,
        service_code_on_dlv_address_br as servicecodeondlvaddress_br,
        null as interestcode_br,
        null as finecode_br,
        vattax_agent_ru as vattaxagent_ru,
        tax_withhold_vendor_type_th as taxwithholdvendortype_th,
        null as vatoperationcode_ru,
        vatpartner_kind_ru as vatpartnerkind_ru,
        invent_profile_type_ru as inventprofiletype_ru,
        null as inventprofileid_ru,
        united_vatinvoice_lt as unitedvatinvoice_lt,
        cons_day_jp as consday_jp,
        null as structdepartment_ru,
        null as bankcentralbanktranstypecur_ru,
        null as bankorderofpayment_ru,
        null as enterprisecode,
        null as regnum_w,
        null as commercialregistersection,
        null as commercialregisterinsetnumber,
        null as commercialregister,
        is_resident_lv as isresident_lv,
        null as intbank_lv,
        null as ciscompanyregnum,
        null as cisnationalinsurancenum,
        cisstatus as cisstatus,
        null as cisuniquetaxpayerref,
        cisverification_date as cisverificationdate,
        null as cisverificationnum,
        null as defaultinventstatusid,
        disabled_owned as disabledowned,
        null as ethnicoriginid,
        foreign_resident_ru as foreignresident_ru,
        hubzone as hubzone,
        is_paym_fee_covered_jp as ispaymfeecovered_jp,
        lv_paym_trans_codes as lvpaymtranscodes,
        mandatory_vat_date_pl as mandatoryvatdate_pl,
        null as separatedivisionid_ru,
        null as tamrebategroupid,
        null as taxperiodpaymentcode_pl,
        use_cash_disc as usecashdisc,
        veteran_owned as veteranowned,
        null as vendpaymfeegroup_jp,
        null as foreignerid_br,
        presence_type_br as presencetype_br,
        vendorportaladministratorrecid as vendorportaladministratorrecid,
        modifieddatetime as modifieddatetime,
        null as del_modifiedtime,
        modifiedby as modifiedby,
        createddatetime as createddatetime,
        null as del_createdtime,
        createdby as createdby,
        upper(data_area_id) as dataareaid,
        recversion as recversion,
        partition as partition,
        recid as recid,
        null as biseanbarcodesetupid,
        null as biseancodeid,
        null as bisedipartner,
        null as bisitemcoding,
        null as bisitemcodingbarcodesetupid,
        null as bisitemcodinggtinsetup,
        fatcafiling_requirement as fatcafilingrequirement

    from d365_source
)

select * from renamed
