with d365_source as (
        select *
        from {{ source("D365", "vend_invoice_jour") }} where _FIVETRAN_DELETED='FALSE' and upper(data_area_id) in {{env_var("DBT_D365_COMPANY_FILTER")}}

    ),

renamed as (

    select
        'D365' as source,
        vend_group as vendgroup,
        purch_id as purchid,
        order_account as orderaccount,
        invoice_account as invoiceaccount,
        invoice_id as invoiceid,
        invoice_date as invoicedate,
        due_date as duedate,
        cash_disc as cashdisc,
        cash_disc_date as cashdiscdate,
        qty as qty,
        volume as volume,
        weight as weight,
        sum_line_disc as sumlinedisc,
        prepayment as prepayment,
        sales_balance as salesbalance,
        end_disc as enddisc,
        invoice_amount as invoiceamount,
        currency_code as currencycode,
        exch_rate as exchrate,
        null as enterprisenumber,
        null as returnitemnum,
        tax_round_off as taxroundoff,
        ledger_voucher as ledgervoucher,
        tax_print_on_invoice as taxprintoninvoice,
        tax_specify_by_line as taxspecifybyline,
        null as documentnum,
        document_date as documentdate,
        country_region_id as countryregionid,
        intrastat_dispatch as intrastatdispatch,
        invoice_round_off as invoiceroundoff,
        sum_markup as summarkup,
        null as paymid,
        tax_group as taxgroup,
        null as cashdisccode,
        cash_disc_percent as cashdiscpercent,
        payment as payment,
        posting_profile as postingprofile,
        null as paymentsched,
        inter_company_posted as intercompanyposted,
        purchase_type as purchasetype,
        sum_tax as sumtax,
        parm_id as parmid,
        exch_rate_secondary as exchratesecondary,
        triangulation as triangulation,
        null as itembuyergroupid,
        vatnum as vatnum,
        internal_invoice_id as internalinvoiceid,
        null as numbersequencegroup,
        incl_tax as incltax,
        null as paymdayid,
        dlv_term as dlvterm,
        dlv_mode as dlvmode,
        fixed_due_date as fixedduedate,
        inter_company_company_id as intercompanycompanyid,
        null as intercompanysalesid,
        null as intercompanyledgervoucher,
        proforma as proforma,
        language_id as languageid,
        invoice_amount_mst as invoiceamountmst,
        sum_markup_mst as summarkupmst,
        end_disc_mst as enddiscmst,
        null as reversecharge_uk,
        document_origin as documentorigin,
        null as vendinvoicegroup,
        null as vendpaymentgroup,
        default_dimension as defaultdimension,
        description as description,
        null as contractnum_sa,
        remittance_address as remittanceaddress,
        vend_invoice_declaration_is as vendinvoicedeclaration_is,
        cost_ledger_voucher as costledgervoucher,
        source_document_header as sourcedocumentheader,
        source_document_line as sourcedocumentline,
        operation_type_mx as operationtype_mx,
        listcode as listcode,
        null as eusaleslist,
        null as vendorrequestedworkeremail,
        logistics_electronic_address as logisticselectronicaddress,
        bank_lcimport_line as banklcimportline,
        invoice_type as invoicetype,
        delivery_name as deliveryname,
        delivery_date_es as deliverydate_es,
        purch_receipt_date_w as purchreceiptdate_w,
        vaton_payment_ru as vatonpayment_ru,
        correct_ru as correct_ru,
        who_is_author_lt as whoisauthor_lt,
        null as invoicestatus_lt,
        invent_profile_type_ru as inventprofiletype_ru,
        null as taxinvoicepurchid,
        null as numbersequencecode_lt,
        corrected_invoice_date_ru as correctedinvoicedate_ru,
        vatamount_in as vatamount_in,
        tax_withhold_amount_in as taxwithholdamount_in,
        vend_cons_invoice_jp as vendconsinvoice_jp,
        null as deliveryname_lt,
        null as deliveryaddress_lt,
        intrastat_fulfillment_date_hu as intrastatfulfillmentdate_hu,
        united_vatinvoice_lt as unitedvatinvoice_lt,
        non_real_revenue_ru as nonrealrevenue_ru,
        null as offsessionid_ru,
        null as consigneeaccount_ru,
        null as consignoraccount_ru,
        factured_fully_ru as facturedfully_ru,
        null as attorneyissuedname_ru,
        null as attorneyid_ru,
        attorney_date_ru as attorneydate_ru,
        state_invoice_printed_lv as stateinvoiceprinted_lv,
        null as dlvaddress_lv,
        intrastat_add_value_lv as intrastataddvalue_lv,
        null as invoiceregister_lt,
        purch_agreement_header_psn as purchagreementheader_psn,
        cons_target_jp as constarget_jp,
        null as correctedinvoiceid_ru,
        correction_type_ru as correctiontype_ru,
        delivery_postal_address as deliverypostaladdress,
        fiscal_document_type_br as fiscaldocumenttype_br,
        null as inventbaileereceiptreportid_ru,
        reason_table_ref_br as reasontableref_br,
        sales_purch_operation_type_br as salespurchoperationtype_br,
        service_code_on_dlv_address_br as servicecodeondlvaddress_br,
        null as taxsetoffvoucher_in,
        null as transitcontrolvoucher_br,
        transportation_document as transportationdocument,
        vend_final_user_br as vendfinaluser_br,
        modifieddatetime as modifieddatetime,
        createddatetime as createddatetime,
        createdby as createdby,
        upper(data_area_id) as dataareaid,
        recversion as recversion,
        partition as partition,
        recid as recid,
        null as cfdiuuid_mx,
        null as invoiceseries_mx,
        null as invoiceidentification_in

from d365_source

)

select * from renamed
