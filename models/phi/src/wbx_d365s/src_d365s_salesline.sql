with d365source as (
    select *
    from {{ source("D365S", "salesline") }}
    where
        _fivetran_deleted = 'FALSE'
        and upper(dataareaid) in {{ env_var("DBT_D365_COMPANY_FILTER") }}

),

renamed as (


    select
        'D365S' as source,
        salesid as salesid,
        cast(linenum as decimal(15, 2)) as linenum,
        itemid as itemid,
        salesstatus as salesstatus,
        name as name,
        externalitemid as externalitemid,
        taxgroup as taxgroup,
        qtyordered as qtyordered,
        salesdelivernow as salesdelivernow,
        remainsalesphysical as remainsalesphysical,
        remainsalesfinancial as remainsalesfinancial,
        costprice as costprice,
        salesprice as salesprice,
        currencycode as currencycode,
        linepercent as linepercent,
        linedisc as linedisc,
        lineamount as lineamount,
        cast(confirmeddlv as timestamp_ntz) as confirmeddlv,
        reservation as reservation,
        null as salesgroup,
        salesunit as salesunit,
        priceunit as priceunit,
        null as projtransid,
        inventtransid as inventtransid,
        custgroup as custgroup,
        custaccount as custaccount,
        salesqty as salesqty,
        salesmarkup as salesmarkup,
        inventdelivernow as inventdelivernow,
        multilndisc as multilndisc,
        multilnpercent as multilnpercent,
        salestype as salestype,
        blocked as blocked,
        complete as complete,
        remaininventphysical as remaininventphysical,
        null as transactioncode,
        null as countyorigdest,
        taxitemgroup as taxitemgroup,
        taxautogenerated as taxautogenerated,
        underdeliverypct as underdeliverypct,
        overdeliverypct as overdeliverypct,
        barcode as barcode,
        barcodetype as barcodetype,
        inventreftransid as inventreftransid,
        inventreftype as inventreftype,
        inventrefid as inventrefid,
        intercompanyorigin as intercompanyorigin,
        null as itembomid,
        null as itemrouteid,
        null as lineheader,
        scrap as scrap,
        dlvmode as dlvmode,
        inventtransidreturn as inventtransidreturn,
        null as projcategoryid,
        null as projid,
        inventdimid as inventdimid,
        null as transport,
        null as statprocid,
        null as port,
        null as projlinepropertyid,
        cast(receiptdaterequested as timestamp_ntz) as receiptdaterequested,
        customerlinenum as customerlinenum,
        packingunitqty as packingunitqty,
        packingunit as packingunit,
        intercompanyinventtransid as intercompanyinventtransid,
        remaininventfinancial as remaininventfinancial,
        deliveryname as deliveryname,
        deliverytype as deliverytype,
        customerref as customerref,
        purchorderformnum as purchorderformnum,
        cast(receiptdateconfirmed as timestamp_ntz) as receiptdateconfirmed,
        stattriangulardeal as stattriangulardeal,
        cast(shippingdaterequested as timestamp_ntz) as shippingdaterequested,
        cast(shippingdateconfirmed as timestamp_ntz) as shippingdateconfirmed,
        addressrefrecid as addressrefrecid,
        addressreftableid as addressreftableid,
        null as serviceorderid,
        itemtagging as itemtagging,
        casetagging as casetagging,
        pallettagging as pallettagging,
        linedeliverytype as linedeliverytype,
        null as einvoiceaccountcode,
        null as shipcarrierid,
        null as shipcarrieraccount,
        shipcarrierdlvtype as shipcarrierdlvtype,
        null as shipcarrieraccountcode,
        salescategory as salescategory,
        deliverydatecontroltype as deliverydatecontroltype,
        null as activitynumber,
        ledgerdimension as ledgerdimension,
        returnallowreservation as returnallowreservation,
        matchingagreementline as matchingagreementline,
        systementrysource as systementrysource,
        systementrychangepolicy as systementrychangepolicy,
        manualentrychangepolicy as manualentrychangepolicy,
        itemreplaced as itemreplaced,
        cast(returndeadline as timestamp_ntz) as returndeadline,
        expectedretqty as expectedretqty,
        returnstatus as returnstatus,
        cast(returnarrivaldate as timestamp_ntz) as returnarrivaldate,
        cast(returncloseddate as timestamp_ntz) as returncloseddate,
        returndispositioncodeid as returndispositioncodeid,
        deliverypostaladdress as deliverypostaladdress,
        shipcarrierpostaladdress as shipcarrierpostaladdress,
        null as shipcarriername,
        defaultdimension as defaultdimension,
        sourcedocumentline as sourcedocumentline,
        taxwithholditemgroupheading_th as taxwithholditemgroupheading_th,
        stockedproduct as stockedproduct,
        null as customsname_mx,
        null as customsdocnumber_mx,
        cast(customsdocdate_mx as timestamp_ntz) as customsdocdate_mx,
        null as propertynumber_mx,
        null as itempbaid,
        refreturninvoicetrans_w as refreturninvoicetrans_w,
        null as postingprofile_ru,
        null as taxwithholdgroup,
        cast(intrastatfulfillmentdate_hu as timestamp_ntz)
            as intrastatfulfillmentdate_hu,
        null as assetid_ru,
        statisticvalue_lt as statisticvalue_lt,
        creditnoteinternalref_pl as creditnoteinternalref_pl,
        psaprojproposalqty as psaprojproposalqty,
        psaprojproposalinventqty as psaprojproposalinventqty,
        pdsexcludefromrebate as pdsexcludefromrebate,
        retailvariantid as retailvariantid,
        agreementskipautolink as agreementskipautolink,
        null as countryregionname_ru,
        creditnotereasoncode as creditnotereasoncode,
        null as deliverytaxgroup_br,
        null as deliverytaxitemgroup_br,
        dlvterm as dlvterm,
        null as invoicegtdid_ru,
        mcrorderline_2_pricehistoryref as mcrorderline2pricehistoryref,
        pdsbatchattribautores as pdsbatchattribautores,
        pdscwexpectedretqty as pdscwexpectedretqty,
        pdscwinventdelivernow as pdscwinventdelivernow,
        pdscwqty as pdscwqty,
        pdscwremaininventfinancial as pdscwremaininventfinancial,
        pdscwremaininventphysical as pdscwremaininventphysical,
        null as pdsitemrebategroupid,
        pdssamelot as pdssamelot,
        pdssamelotoverride as pdssamelotoverride,
        cast(priceagreementdate_ru as timestamp_ntz) as priceagreementdate_ru,
        null as psacontractlinenum,
        retailblockqty as retailblockqty,
        cast(modifieddatetime as timestamp_ntz) as modifieddatetime,
        null as del_modifiedtime,
        modifiedby as modifiedby,
        cast(createddatetime as timestamp_ntz) as createddatetime,
        null as del_createdtime,
        createdby as createdby,
        upper(dataareaid) as dataareaid,
        recversion as recversion,
        partition as partition,
        recid as recid,
        null as wbxshelflife,
        null as wbxvariantmemo,
        null as orderlinereference_no,
        null as satunitcode_mx,
        null as satproductcode_mx


    from d365source

)

select * from renamed


