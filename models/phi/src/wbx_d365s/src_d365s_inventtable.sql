
with d365source as (
    select *
    from {{ source("D365S", "inventtable") }}
    where
        _fivetran_deleted = 'FALSE'
        and upper(trim(dataareaid)) in {{ env_var("DBT_D365_COMPANY_FILTER") }}

),

renamed as (
    select
        'D365S' as source,
        itemid as itemid,
        itemtype as itemtype,
        purchmodel as purchmodel,
        height as height,
        width as width,
        salesmodel as salesmodel,
        costgroupid as costgroupid,
        reqgroupid as reqgroupid,
        null as epcmanager,
        primaryvendorid as primaryvendorid,
        netweight as netweight,
        depth as depth,
        unitvolume as unitvolume,
        bomunitid as bomunitid,
        null as itempricetolerancegroupid,
        density as density,
        costmodel as costmodel,
        usealtitemid as usealtitemid,
        altitemid as altitemid,
        matchingpolicy as matchingpolicy,
        null as intracode,
        prodflushingprincip as prodflushingprincip,
        minimumpalletquantity as minimumpalletquantity,
        null as pbaitemautogenerated,
        wmsarrivalhandlingtime as wmsarrivalhandlingtime,
        bommanualreceipt as bommanualreceipt,
        phantom as phantom,
        null as intraunit,
        bomlevel as bomlevel,
        batchnumgroupid as batchnumgroupid,
        autoreportfinished as autoreportfinished,
        origcountryregionid as origcountryregionid,
        statisticsfactor as statisticsfactor,
        null as altconfigid,
        null as standardconfigid,
        null as prodpoolid,
        null as propertyid,
        abctieup as abctieup,
        abcrevenue as abcrevenue,
        abcvalue as abcvalue,
        abccontributionmargin as abccontributionmargin,
        null as commissiongroupid,
        salespercentmarkup as salespercentmarkup,
        salescontributionratio as salescontributionratio,
        salespricemodelbasic as salespricemodelbasic,
        namealias as namealias,
        null as prodgroupid,
        projcategoryid as projcategoryid,
        grossdepth as grossdepth,
        grosswidth as grosswidth,
        grossheight as grossheight,
        standardpalletquantity as standardpalletquantity,
        qtyperlayer as qtyperlayer,
        sortcode as sortcode,
        serialnumgroupid as serialnumgroupid,
        itembuyergroupid as itembuyergroupid,
        taxpackagingqty as taxpackagingqty,
        null as wmspallettypeid,
        null as origstateid,
        wmspickingqtytime as wmspickingqtytime,
        taraweight as taraweight,
        null as packaginggroupid,
        scrapvar as scrapvar,
        scrapconst as scrapconst,
        null as standardinventcolorid,
        standardinventsizeid as standardinventsizeid,
        itemdimcostprice as itemdimcostprice,
        null as altinventsizeid,
        null as altinventcolorid,
        forecastdmpinclude as forecastdmpinclude,
        product as product,
        null as pallettagging,
        null as itemtagginglevel,
        defaultdimension as defaultdimension,
        fiscallifoavoidcalc as fiscallifoavoidcalc,
        fiscallifonormalvalue as fiscallifonormalvalue,
        fiscallifonormalvaluecalc as fiscallifonormalvaluecalc,
        bomcalcgroupid as bomcalcgroupid,
        inventfiscallifogroup as inventfiscallifogroup,
        ngpcodestable_fr as ngpcodestable_fr,
        null as origcountyid,
        null as taxfiscalclassification_br,
        null as pbaitemconfigurable,
        null as pbainventitemgroupid,
        null as pbahidedialog,
        null as pbahideapproval,
        null as pbaautostart,
        null as pbamandatoryconfig,
        null as inventproducttype_br,
        taxationorigin_br as taxationorigin_br,
        null as taxservicecode_br,
        excisetariffcodes_in as excisetariffcodes_in,
        customsexporttariffcodetable_in as customsexporttariffcodetbl_in,
        customsimporttariffcodetable_in as customsimporttariffcodetbl_in,
        servicecodetable_in as servicecodetable_in,
        eximproductgrouptable_in as eximproductgrouptable_in,
        null as packing_ru,
        null as assetgroupid_ru,
        null as assetid_ru,
        intrastatexclude as intrastatexclude,
        null as intrastatprocid_cz,
        null as pkwiucode_pl,
        null as exceptioncode_br,
        icmsonservice_br as icmsonservice_br,
        pdscwwmsstandardpalletqty as pdscwwmsstandardpalletqty,
        pdscwwmsminimumpalletqty as pdscwwmsminimumpalletqty,
        pdscwwmsqtyperlayer as pdscwwmsqtyperlayer,
        null as alcoholmanufacturerid_ru,
        null as alcoholproductiontypeid_ru,
        alcoholstrength_ru as alcoholstrength_ru,
        null as altinventstyleid,
        approxtaxvalue_br as approxtaxvalue_br,
        batchmergedatecalculationmethod as batchmergedatecalcmethod,
        null as daxintegrationkey,
        null as markupcode_ru,
        null as nrtaxgroup_lv,
        null as pdsbaseattributeid,
        pdsbestbefore as pdsbestbefore,
        null as pdsfreightallocationgroupid,
        null as pdsitemrebategroupid,
        pdspotencyattribrecording as pdspotencyattribrecording,
        pdsshelfadvice as pdsshelfadvice,
        pdsshelflife as pdsshelflife,
        pdstargetfactor as pdstargetfactor,
        pdsvendorcheckitem as pdsvendorcheckitem,
        null as pmfplanningitemid,
        pmfproducttype as pmfproducttype,
        pmfyieldpct as pmfyieldpct,
        null as sadratecode_pl,
        skipintracompanysync_ru as skipintracompanysync_ru,
        null as standardinventstyleid,
        dsa_in as dsa_in,
        exciserecordtype_in as exciserecordtype_in,
        cast(modifieddatetime as TIMESTAMP_NTZ) as modifieddatetime,
        null as del_modifiedtime,
        modifiedby as modifiedby,
        cast(createddatetime as TIMESTAMP_NTZ) as createddatetime,
        null as del_createdtime,
        createdby as createdby,
        upper(dataareaid) as dataareaid,
        recversion as recversion,
        partition as partition,
        recid as recid,
        null as wbxautomaticformulachange,
        null as wbxcycletimessc,
        serviceaccountingcodetable_in as serviceaccountingcodetable_in,
        exempt_in as exempt_in,
        hsncodetable_in as hsncodetable_in,
        null as includedemandforecast,
        null as avpweight,
        null as consumerunit,
        null as currentflag,
        null as inventbrandingcodeid,
        null as inventpacksizecodeid,
        null as inventproductclasscodeid,
        null as inventstrategiccodeid,
        null as inventsubproductcodeid,
        null as pmpflag,
        null as avpflag,
        null as satcodeid_mx,
        null as undershelflife,
        null as overshelflife

    from d365source

)

select *
from renamed
