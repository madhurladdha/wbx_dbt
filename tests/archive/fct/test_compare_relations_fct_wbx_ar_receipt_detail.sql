{{ config(enabled=false, severity='warn', warn_if='>0') }}

{% set old_etl_relation = ref('conv_fin_wtx_ar_receiptdetail_fact') %}

{% set dbt_relation = ref('fct_wbx_fin_ar_receipt_detail') %}

{{
    ent_dbt_package.compare_relations(
        a_relation=old_etl_relation,
        b_relation=dbt_relation,
        exclude_columns=["AR_INV_RECEIPTDETAIL_GUID","ACCOUNT_GUID","CUST_PARNT_ADDRESS_NUMBER_GUID","DISCOUNT_ACCOUNT_GUID","WRITEOFF_ACCOUNT_GUID","CHARGEBACK_ACCOUNT_GUID","DEDUCTION_ACCOUNT_GUID","BUSINESS_UNIT_ADDRESS_GUID","SUBLEDGER_GUID","CUSTOMER_ADDRESS_NUMBER_GUID","PAYOR_ADDRESS_NUMBER_GUID","AR_CUSTINV_HDR_GUID","DEDUCTION_DOCUMENT_GUID","MATCHING_DOCUMENT_TYPE","MATCHING_CHECK_DATE","BATCH_TYPE","BATCH_NUMBER","BATCH_DATE","SOURCE_CUST_PARENT_IDENTIFIER","CUST_PARNT_ADDRESS_NUMBER_GUID","RELATED_PAYMENT_IDENTIFIER","RELATED_PAYMENT_LINE_NUMBER","RECEIPT_TYPE_CODE","SOURCE_SUBLEDGER_IDENTIFIER","SUBLEDGER_GUID","SOURCE_SUBLEDGER_TYPE","SUBLEDGER_TYPE_DESC","PO_ORDER_COMPANY","PO_ORDER_NUMBER","PO_ORDER_TYPE","ORIGINAL_DOCUMENT_NUMBER","ORIGINAL_DOCUMENT_TYPE","ORIGINAL_DOCUMENT_COMPANY","ORIGINAL_DOCUMENT_PAY_ITEM","RECEIPT_NSF_VOID_FLAG","TRANSACTION_ORIGINATOR","CUSTOMER_BANK_ACCOUNT_NO","PAYEE_NAME_TXT","NSF_VOID_DOCUMENT_NUMBER","NSF_DOCUMENT_TYPE","NSF_DOCUMENT_COMPANY","NSF_BATCH_TYPE","NSF_BATCH_NUMBER","NSF_BATCH_DATE","NSF_POSTED_CODE","LOAD_STATUS","LOAD_DATE","UPDATE_DATE","SOURCE_DATE_UPDATED","AR_CUSTINV_HDR_UNIQUE_KEY"],
        primary_key="UNIQUE_KEY",
        summarize=true,
    )
}}